angular.module("gthiveApp",["app.routes","mainCtrl","buildingCtrl","buildingService","uiGmapgoogle-maps","smart-table"]).config(["uiGmapGoogleMapApiProvider",function(e){e.configure({v:"3.20",libraries:"geometry,visualization"})}]),angular.module("app.routes",["ngRoute"]).config(["$routeProvider","$locationProvider",function(e,i){e.when("/",{templateUrl:"app/views/pages/home.html"}).when("/login",{templateUrl:"app/views/pages/login.html"}).when("/buildings/:bid",{templateUrl:"app/views/pages/building.html",controller:"buildingController"}),i.html5Mode(!0)}]),angular.module("buildingCtrl",["buildingService","chart.js"]).controller("buildingController",["$scope","$routeParams","Building",function(e,i,o){e.labels=[["monday","tuesday","wednesday","thursday","4","5","5"],["monday","tuesday","wednesday","thursday","4","5","5"]],e.series=["Average","Today"],o.get(i.bid).then(function(o){console.log("got chart data for bid=",i.bid),e.data=[[28,48,40,19,86,27,90],[65,59,80,81,56,55,40]]})}]),angular.module("mainCtrl",["uiGmapgoogle-maps","buildingService"]).controller("mainController",["$scope","uiGmapGoogleMapApi","Building","$log",function(e,i,o,n){var t=this;t.processing=!0,e.markers=[],e.safeBuildings=[],e.itemsByPage=15,e.selectedMarker={},e.infoWindow={options:{show:!1},templateUrl:"app/views/templates/info.html",templateParameter:{title:"",occupancy:"",building_id:-1}},e.rowCollection=[{firstName:"Laurent",lastName:"Renard",balance:102,email:"whatever@gmail.com"},{firstName:"Blandine",lastName:"Faivre",balance:-2323.22,email:"oufblandou@gmail.com"},{firstName:"Francoise",lastName:"Frere",balance:42343,email:"raymondef@gmail.com"}],e.mapOptions={disableDefaultUI:!0,scrollwheel:!1,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"labels",stylers:[{visibility:"on"}]}]},e.closeClick=function(){e.infoWindow.options.show=!1},i.then(function(i){return e.map={center:{latitude:33.7764,longitude:-84.3985},zoom:16,options:e.mapOptions},o.all()}).then(function(i){t.buildings=[],i.data.forEach(function(i){e.safeBuildings.push(i),i.show_on_map&&t.buildings.push(i)});for(var o=function(i,o){var a={id:i,coords:{latitude:o.latitude,longitude:o.longitude},options:{title:o.name,labelContent:o.abbreviation}};return o.occupancy<=40?a.icon="http://maps.google.com/mapfiles/ms/icons/green-dot.png":o.occupancy<=80?a.icon="http://maps.google.com/mapfiles/ms/icons/yellow-dot.png":a.icon="http://maps.google.com/mapfiles/ms/icons/red-dot.png",a.onClick=function(){n.log(a.options.title+" clicked!"),e.$apply(function(){e.selectedMarker=a,e.infoWindow.templateParameter.title=a.options.title,e.infoWindow.templateParameter.occupancy=t.buildings[a.id].occupancy,console.log("marker id",a.id),console.log("bid",t.buildings[a.id].bid),e.infoWindow.templateParameter.building_id=t.buildings[a.id].bid,e.infoWindow.options.show=!0})},a},a=0;a<t.buildings.length;a++)e.markers.push(o(a,t.buildings[a]))})["catch"](function(){n.log("Error occurred, see logs.")}).then(function(){t.processing=!1})}]),angular.module("buildingService",[]).factory("Building",["$http","$log",function(e,i){var o={};return o.all=function(){return e.get("/api/buildings")},o.get=function(i){return e.get("/api/buildings/"+i)},o.chartData=function(i){return e.get("/api/chartdata/"+i)},o}]);