angular.module("gthiveApp",["app.routes","mainCtrl","buildingService","uiGmapgoogle-maps"]).config(["uiGmapGoogleMapApiProvider",function(i){i.configure({v:"3.20",libraries:"geometry,visualization"})}]),angular.module("app.routes",["ngRoute"]).config(["$routeProvider","$locationProvider",function(i,n){i.when("/",{templateUrl:"app/views/pages/home.html",controller:"mainController",controllerAs:"main"}),n.html5Mode(!0)}]),angular.module("mainCtrl",["uiGmapgoogle-maps","buildingService"]).controller("mainController",["$scope","uiGmapGoogleMapApi","Building","$log",function(i,n,o,e){var t=this;i.markers=[],t.processing=!0,n.then(function(n){return i.map={center:{latitude:33.7753,longitude:-84.3975},zoom:16},o.all()}).then(function(i){t.buildings=i.data;for(var n=[],e=0;e<t.buildings.length;e++)n.push(t.buildings[e].bid);return o.updateOccupancies(n)}).then(function(n){for(var o=0;o<t.buildings.length;o++)t.buildings[o].occupancy=n.data.occupancies[t.buildings[o].bid].occupancy;t.processing=!1;var e=function(i,n){var o={id:i,title:n.name,latitude:n.latitude,longitude:n.longitude};return n.occupancy<=40?o.icon="http://maps.google.com/mapfiles/ms/icons/green-dot.png":n.occupancy<=80?o.icon="http://maps.google.com/mapfiles/ms/icons/yellow-dot.png":o.icon="http://maps.google.com/mapfiles/ms/icons/red-dot.png",o};for(o=0;o<t.buildings.length;o++)i.markers.push(e(o,t.buildings[o]))})}]),angular.module("buildingService",[]).factory("Building",["$http","$log",function(i,n){var o={};return o.all=function(){return i.get("/api/angular/buildings")},o.getOccupancy=function(n){return i.get("/api/locationinfo/b_id="+n)},o.updateOccupancies=function(n){for(var o="",e=n.length,t=0;e-1>t;t++)o+="b_id="+n[t]+"&";return o+="b_id="+n[e-1],i.get("/api/locationinfo/"+o)},o}]);